<!DOCTYPE html>
<html lang="en">
<head>
  <title>Rijksstudio</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
  
<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">Rijksstudio</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#collapsibleNavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="collapsibleNavbar">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="#">Link1</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Link2</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Link123</a>
        </li>    
      </ul>
    </div>
  </div>
</nav>
<br>

<div class="row">


  <div class="col-sm-8">
    <a style="pointer-events:auto; cursor:crosshair;" id="painting_click" href="#">
      <img id="painting" src={{url}} alt="painting" width={{width}} height={{height}} ismap>
    </a>
  </div>


    <div class="col-sm-4 bg-dark text-white">
    <br>
    <div class="row" style="height: 100px;">
      <div id="obj_find" class="col-12 text-center">
        <p>Find the <u id="object">{{ name }}</u></p> <p id="rem">({{ total_objects }} objects remaining for this painting)</p> 
      </div>
    </div>
    <br>
    <div class="row" style="height: 100px;" >
      <div id = "score" class="col-12 text-center">
        Score: 0 
      </div>
    </div>
     <br>
    <div class="row" style="height: 100px;">
      <button onClick="window.location.reload();" type="button" class="btn btn-success"> Next Object and painting</button>
    </div>
     <br>
    <div class="row" style="height: 100px;">
      <button onClick="window.location.reload();" type="button" class="btn btn-success">Object not present</button>
    </div>
     <br>
  </div>

</div>
<br>


<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
                        
<script type=text/javascript>
  $(document).ready(function(){
      $("a#painting_click").on("click", function(event) {
          event.preventDefault();
          var me = this;

          x = event.clientX - document.getElementById('painting').offsetLeft; 
          y = event.clientY - document.getElementById('painting').offsetTop; 

          $.ajax({
              type: "POST",
              url: "{{url_for('calculate_score')}}",
              contentType: 'application/json',
              data: JSON.stringify({x: x, y: y, time: 0,
              cache: false})
          }).done(function(data) {
              document.getElementById("score").innerHTML = "Score: " + data.total_score;

              document.getElementById("score").innerHTML += "<span class='pop-up' id='success_msg' style='color:greenyellow'>" + data.msg + "</span>"
              $("#success_msg").delay(2500).fadeOut();
              
              $("#painting").attr("src", data.url);

              if (data.obj == ""){
                  document.getElementById("obj_find").innerHTML = "No objects remaining in this painting!";
                  $(me).css({"pointer-events": "none", "cursor": "default"});
              }else{
                  document.getElementById("object").innerHTML = data.obj;
                  document.getElementById("rem").innerHTML = "(" + data.rem + " objects remaining for this painting)"
              }


          });
      });
  });

</script>

<form>
</form>

</body>
</html>


